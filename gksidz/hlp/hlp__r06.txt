
 Описание работы регулятора:  ДОЗИРОВКА СУХОГО [6]
 =================================================


НАЧАЛО:

         Если регулятор выключен (REG06R___V=OFF) - выйти.


ШАГ 00:

         Если дозатор сухого выгружен (DON801___V=OFF) и оператор дал
         комманду для начала загрузки (DIS701___V=ON ) - перейти на ШАГ 01

-------
ШАГ 01:
         Если аспирация цемента в ручном режиме (DIR160___V=MANUAL) или
         подкачка цемента не закончилась (FLAG_0506A=OFF) - перейти на ШАГ 03

         Включить шнек аспирации цемента (DON162___V=ON)
         Обнулить счетчик времени запоминания веса (LOAD_CCNTC=0)
         Перейти на ШАГ 02.


ШАГ 02:
         Через определенное время (TIME_CCVSV) запоминать текущий вес 
        (AIW190___V) дозатора сухого.

         Если текущий вес (AIW190___V) больше общего заданного (TRCEM__VIB)
         для набора цемента или текущий вес (AIW190___V) больше заданного 
         веса загрузки цемента из аспирации (LOAD_CAVSV)-
         выключить шнек аспирации цемента (DON162___V=OFF) и 
         перейти на ШАГ 03.

         Вычислить разницу текущего и предыдущего взвешивания
         LOAD_CCDRC = AIW190___V- AIW190___O;

        -Если разница текущего допустимого веса (LOAD_CCDRC) меньше заданного
         допустимого веса для разницы (LOAD_CCDRV)- увеличить счетчик 
         стабилизации веса (LOAD_CCNTC++)
        -Иначе обнулить счетчик (LOAD_CCNTC=0)

         Если счетчик стабилизации веса (LOAD_CCNTC) больше заданного 
        (LOAD_CCNTV)- значит больше набирать уже нечего 
        (цемент в аспирации закончился).
         Выключить шнек аспирации цемента (DON162___V=OFF) 
         Сбросить флаг окончания загрузки цемента в бункер
        (флаг наличия цемента в аспирации)(FLAG_0506A=OFF) и перейти на ШАГ 03.

-------
ШАГ 03:
         Выключить шнек аспирации цемента (DON162___V=OFF).

         Если дозировка цемента в ручном режиме (DIR170___V=MANUAL)- 
         перейти на ШАГ 06.

         Открыть клапан подачи цемента на шнек (DON172___V=ON).

         Включить шнек дозировки цемента (DON180___V=ON).

         Перейти на ШАГ 04.


ШАГ 04:
         Открыть клапан дозировки цемента ГРУБО (DON181___V=ON).

         Открыть клапан дозировки цемента ТОЧНО (DON182___V=ON).

         Запомнить текущий вес дозатора для следующей проверки
         веса включения вибраторов (LOAD_SHDMC=AIW190___V).

         Обнулить счетчики контроля веса и времени для следующего шага
         TIME_SHDMC= 0; TIME_ONVBC= 0; CNT_SHVBON= 0;

         Перейти на ШАГ 05.


ШАГ 05:
         Каждую секунду
            запомнить текущий вес

            если значение счетчика меньше допустимого (TIME_SHDMC<10000) и 
            выключен клапан воздуха (DIS171___V=OFF)-
            увеличить значение счетчика таймера проверки (TIME_SHDMC++).
           
            если значение счетчика меньше допустимого (TIME_ONVBC<10000)- 
            увеличить значение счетчика времени включения вибратора
            (TIME_ONVBC++).

        Если тек.счетчик времени проверки веса включения вибраторов(TIME_SHDMC)
        больше заданного (TIME_SHDMV) и текущий вес (AIW190___V) меньше чем 
        заданный вес загрузки цемента минус вес отсечки грубо и минус 20 кг
        (TRCEM__VIB-LOAD_CCGRV-20) и клапан воздуха закрыт (DIS171___V=OFF)-

            Если разница между текущим весом и запомненным 
            (AIW190___V-LOAD_SHDMC) меньше чем задано для включения 
            вибраторов (LOAD_SHDMV)

                Если счетчик включения вибратора цемента (CNT_SHVBON)
                больше 1-закрыть клапан подачи цемента на шнек (DON172___V=OFF).
                Иначе- включить вибратор (DON173___V=ON).

                Сбросить счетчик включения вибратора (TIME_ONVBC=0).

                Запомнить текущий вес дозатора для следующей проверки веса
                включения вибраторов (LOAD_SHDMC=AIW190___V).

                Увеличить счетчик количества включения вибратора (CNT_SHVBON++).

            Иначе-

                Обнулить счетчик количества включения вибратора (CNT_SHVBON=0).

                Cбросить счетчик времени проверки включения вибраторов 
               (TIME_SHDMC=0).

        Если счетчик времени включения вибратора больше заданного 
       (TIME_ONVBC>TIME_ONVBV)

            Выключить вибратор (DON173___V=OFF)

            Если был включен подрыв (CNT_SHVBON> 1)

                Обнулить счетчик количества включений вибратора (CNT_SHVBON=0).

                Закрыть клапан воздуха (DON171___V=OFF).

                Открыть клапан подачи цемента на шнек (DON172___V=ON).

                Обнулить счетчик включения вибратора (TIME_ONVBC=0).

        Если текущий вес (AIW190___V) больше общего заданного для набора 
        цемента (TRCEM__VIB) минус заданный вес отсечки ГРУБО (LOAD_CCGRV)-
        закрыть клапан дозировки ГРУБО (DON181___V=OFF).

        Если текущий вес (AIW190___V) больше общего заданного для набора 
        цемента (TRCEM__VIB) минус заданный вес отсечки ТОЧНО (LOAD_CCTCV)-
        закрыть клапан дозировки ТОЧНО (DON182___V=OFF) и перейти на ШАГ 06.

        Если очередь включения подрыва (не вибратора)(CNT_SHVBON>1)

            Закрыть клапан подачи цемента на шнек (DON172___V=OFF)

            Открыть клапан воздуха (DON171___V=ON).


ШАГ 06:
        Закрыть все исполнители бункера цемента
       (DON180___V=OFF; DON171___V=OFF; DON172___V=OFF; DON173___V=OFF)

        Повторное закрытие клапанов дозировки цемента ГРУБО,ТОЧНО (проверка)
        DON181___V = OFF;
        DON182___V = OFF;

        Пауза между загрузкой цемента и вяжущего (TIME_CVPSV*SEC)

        Переход на ШАГ 07.


-------
ШАГ 07:
        Если аспирация вяжущего в ручном режиме (DIR130___V=MANUAL) или
        подкачка  вяжущего не закончилась (FLAG_0406A=OFF)- перейти на ШАГ 09.

        Включить шнек аспирации вяжущего (DON132___V=ON)

        Сбросить счетчик веса (LOAD_CCNTC=0)

        Переход на ШАГ 08.


ШАГ 08:
        Через определенное время запоминать текущий вес (AIW190___V)

        Если текущий вес (AIW190___V) больше общего заданного для набора 
        вяжущего (TRCEM__VIB+TRVYG_VIB) или текущий вес (AIW190___V) больше 
        заданного веса загрузки  вяжущего из аспирации (TRCEM__VIB+LOAD_VAVSV)-
        выключить шнек аспирации вяжущего (DON132___V=OFF) и перейти на ШАГ 09.

        Запомнить разницу текущего и предыдущего взвешивания
        LOAD_CCDRC = AIW190___V- AIW190___O;

        Если разница текущего допустимого веса (LOAD_CCDRC) меньше заданного
        допустимого веса для разницы (LOAD_CCDRV)- увеличить счетчик 
        стабилизации веса (LOAD_CCNTC++)

        Если счетчик стабилизации веса (LOAD_CCNTC) больше заданного 
       (LOAD_CCNTV)- значит больше набирать уже нечего 
       (вяжущего в аспирации нет)-
        выключить шнек аспирации вяжущего (DON132___V=OFF),
        сбросить  флаг загрузки  вяжущего из аспирпации (FLAG_0406A=OFF) и
        перейти на ШАГ 09.

-------
ШАГ 09:
        Выключить шнек аспирации вяжущего (DON132___V=OFF)

        Если загрузка вяжущего в ручном режиме (DIR140___V=MANUAL)- 
        перейти на ШАГ 12.

        Открыть клапан подачи вяжущего на шнек (DON142___V=ON).

        Включить шнек дозировки вяжущего (DON150___V=ON)

        Перейти на ШАГ 10.


ШАГ 10:
        Открыть клапан дозировки вяжущего ГРУБО (DON151___V=ON).

        Открыть клапан дозировки вяжущего ТОЧНО (DON152___V=ON).

        Запомнить текущий вес дозатора для следующей проверки
        веса включения вибраторов (LOAD_SHDMC=AIW190___V)

        Обнулить счетчики контроля веса и времени для следующего шага
        TIME_SHDMC= 0; TIME_ONVBC= 0; CNT_SHVBON= 0;

        перейти на ШАГ 11


ШАГ 11:
         Каждую секунду
            запомнить текущий вес

            если значение счетчика меньше допустимого (TIME_SHDMC<10000) и 
            выключен клапан воздуха (DIS141___V=OFF)-
            увеличить значение счетчика таймера проверки (TIME_SHDMC++).
           
            если значение счетчика меньше допустимого (TIME_ONVBC<10000)- 
            увеличить значение счетчика времени включения вибратора
            (TIME_ONVBC++).

        Если тек.счетчик времени проверки веса включения вибраторов(TIME_SHDMC)
        больше заданного (TIME_SHDMV) и текущий вес (AIW190___V) меньше чем 
        заданный вес загрузки вяжущего минус вес отсечки грубо и минус 20 кг
        (TRCEM__VIB-LOAD_VGGRV-20) и клапан воздуха закрыт (DIS141___V=OFF)-

            Если разница между текущим весом и запомненным 
            (AIW190___V-LOAD_SHDMC) меньше чем задано для включения 
            вибраторов (LOAD_SHDMV)

                Если счетчик включения вибратора вяжущего (CNT_SHVBON)
                больше 1-закрыть клапан подачи вяжущего на шнек (DON142___V=OFF).
                Иначе- включить вибратор (DON143___V=ON).

                Сбросить счетчик включения вибратора (TIME_ONVBC=0).

                Запомнить текущий вес дозатора для следующей проверки веса
                включения вибраторов (LOAD_SHDMC=AIW190___V).

                Увеличить счетчик количества включения вибратора (CNT_SHVBON++).

            Иначе-

                Обнулить счетчик количества включения вибратора (CNT_SHVBON=0).

                Cбросить счетчик времени проверки включения вибраторов 
               (TIME_SHDMC=0).

        Если счетчик времени включения вибратора больше заданного 
       (TIME_ONVBC>TIME_ONVBV)

            Выключить вибратор (DON143___V=OFF)

            Если был включен подрыв (CNT_SHVBON> 1)

                Обнулить счетчик количества включений вибратора (CNT_SHVBON=0).

                Закрыть клапан воздуха (DON141___V=OFF).

                Открыть клапан подачи вяжущего на шнек (DON142___V=ON).

                Обнулить счетчик включения вибратора (TIME_ONVBC=0).

        Если текущий вес (AIW190___V) больше общего заданного для набора 
        вяжущего (TRCEM__VIB+TRVYG__VIB) минус заданный вес отсечки ГРУБО
       (LOAD_VGGRV)-закрыть клапан дозировки ГРУБО (DON151___V=OFF).

        Если текущий вес (AIW190___V) больше общего заданного для набора 
        вяжущего (TRCEM__VIB+TRVYG__VIB) минус заданный вес отсечки ТОЧНО 
       (LOAD_VGTCV)-закрыть клапан дозировки ТОЧНО (DON152___V=OFF) и 
        перейти на ШАГ 12.

        Если очередь включения подрыва (не вибратора)(CNT_SHVBON>1)

            Закрыть клапан подачи вяжущего на шнек (DON142___V=OFF)

            Открыть клапан воздуха (DON141___V=ON).


ШАГ 12:
        Закрыть все исполнители бункера вяжущего 
       (DON150___V =OFF; DON141___V =OFF; DON142___V =OFF; DON143___V =OFF;)

        Проверить закрытие клапанов дозировки вяжущего
        DON151___V = OFF;
        DON152___V = OFF;

        Пауза после загрузки сухого (TIME_CVPSV)

        Перейти на ШАГ 15.


ШАГ 15:
        Установить флаг окончания загрузки сухого (включить первую лампочку)
        (DON801___V=ON)
        
        Перейти на ШАГ 00.

------------------------------------------------------------------------------

